<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 8.00.6001.19170"></meta></head><body>
<h3>Условия использования, если шаблон <font color="#ff0000">не является</font> шаблоном оповещения о днях рождения контактов</h3>
<ul><li>
<div>В алгоритмах возвращаемое значение должно писаться в переменную Результат. Результат может быть массивом;</div>
</li><li>
<div>Параметры указываются через <em>ИмяПараметра</em>. Можно использовать разыменование параметров, например, <em>ИмяПараметра</em>.Наименование.</div></li></ul><h3>Условия использования, если шаблон <font color="#ff0000">является</font> шаблоном оповещения о днях рождения контактов</h3>
<ul><li>
<div>Адресаты рассчитываются автоматически и их переопределить нельзя;</div>
</li><li>
<div>Вложения можно рассчитывать по стандартному условию (см. выше);</div>
</li><li>
<div>Тема и тело сообщения рассчитываются специальным образом (см. ниже).</div></li></ul><h4>Тема сообщения</h4>
<p>В алгоритме темы сообщения результат возвращается в переменную "ТемаСообщения".</p>
<p>Для отладки через кнопку "Проверить" нужно самому написать алгоритм вида:</p>
<p class="SourceCode">ТемаСообщения = "Тру-ля-ля";<br>Если Сообщать = Истина Тогда <br>    Сообщить("Тема сообщения:" + ТемаСообщения);<br>КонецЕсли;</p>
<p>Стандартный алгоритм темы сообщения:</p>
<p class="SourceCode">ТемаСообщения = "Оповещение о днях рождения контактов из CRM";</p>
<h4>Тело сообщения</h4>
<p>В алгоритме тела сообщения результат возвращается в переменные </p>
<ul><li>"ТелоСообщения" - текст на языке HTML 
</li><li>"Шапка" - текст на языке HTML 
</li><li>"Подвал" - текст на языке HTML 
</li><li>"КолонкиТаблицы" - струкутра. Ключ структуры - имя реквизита справочника "Контакты", значение структуры - представление колонки</li></ul><p>Для отладки через кнопку "Проверить" алгоритм нужно написать самому.</p>
<p>Стандартный алгоритм тела сообщения:</p>
<p class="SourceCode"> ТелоСообщения = <br> "&lt;HTML&gt;&lt;HEAD&gt;&lt;META content='text/html; charset=utf-8' http-equiv=Content-Type&gt;&lt;/HEAD&gt;<br> |&lt;BODY&gt;<br> |&lt;P&gt;<font color="#ff0000">[Шапка]</font>&lt;/P&gt;<br> |&lt;TABLE border=1 width='100%' cellSpacing=0 cellPadding=3&gt;<br> |&lt;TBODY&gt;<br> |[ЗаголовокТаблицы]<br> |[СтрокиТаблицы]<br> |&lt;/TBODY&gt;<br> |&lt;/TABLE&gt;<br> |&lt;P&gt;<font color="#ff0000">[Подвал]</font>&lt;/P&gt;<br> |&lt;/BODY&gt;&lt;/HTML&gt;";<br><br> Шапка  = "Добрый день,<br>  |&lt;BR/&gt;напоминаем Вам, что у следующих контактов сегодня день рождения";<br><br> Подвал  = "В случае, если данные в письме не верные,<br>  |&lt;BR/&gt;обращайтесь в службу тех. поддержки &lt;A href='mailto:SOS@sminex.com'&gt;SOS@sminex.com";<br>  <br> КолонкиТаблицы = Новый Структура("Наименование, Должность, Компания, Телефон, ЭлектроннаяПочта", <br>  "ФИО", "Должность", "Компания", "Телефон", "Электронная почта");<br>  <br> // Если сдвиг больше 0, то добавить колонку "День рождения"<br> Если СдвигСрокаОповещенияВДнях &gt; 0 Тогда<br>  КолонкиТаблицы.Вставить("ДеньРождения", "День рождения");<br> КонецЕсли; <br></p></body></html>