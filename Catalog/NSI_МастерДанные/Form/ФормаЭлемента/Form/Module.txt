&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если ЗначениеЗаполнено(Объект.Ссылка) Тогда
		СписокКРазблокировке = Новый Массив;
		//Попытка
		//ЗаблокироватьДанныеДляРедактирования(Объект.Ссылка, , УникальныйИдентификатор);
		//СписокКРазблокировке.Добавить("Объект");
		//Отказ = Отказ ИЛИ Не NSI_РаботаСМастерДаннымиСервер.ЗаблокироватьРегистрСведенийДляИзмененияОбъекта(Объект.Ссылка, "NSI_НепериодическиеПоляМД", УникальныйИдентификатор);
		//СписокКРазблокировке.Добавить("NSI_НепериодическиеПоляМД");
		//Отказ = Отказ ИЛИ Не NSI_РаботаСМастерДаннымиСервер.ЗаблокироватьРегистрСведенийДляИзмененияОбъекта(Объект.Ссылка, "NSI_ПериодическиеПоляМД", УникальныйИдентификатор);
		//СписокКРазблокировке.Добавить("NSI_ПериодическиеПоляМД");
		//Если Отказ Тогда
		//	ВызватьИсключение "Ошибка блокировки";
		//КонецЕсли;
		//Исключение
		//	Сообщить("Объект уже редактируется");
		//	Для Каждого ОбъектДляРазблокировки Из СписокКРазблокировке Цикл
		//		Если ОбъектДляРазблокировки = "Объект" Тогда
		//			РазблокироватьДанныеДляРедактирования(Объект.Ссылка, УникальныйИдентификатор);		
		//		Иначе
		//			NSI_РаботаСМастерДаннымиСервер.РазблокироватьРегистрСведенийДляИзмененияОбъекта(Объект.Ссылка, ОбъектДляРазблокировки, УникальныйИдентификатор);
		//		КонецЕсли;
		//	КонецЦикла;
		//	Отказ = Истина;
		//	СтандартнаяОбработка = Ложь;
		//	Возврат;
		//КонецПопытки;
		NSI_РаботаСМастерДаннымиСервер.ЗаполнитьГруппуФормыПоМакетуВидаМастерДанных(ЭтаФорма, Объект.Владелец, Объект.ЭтоГруппа, Элементы.ГруппаРеквизитов);
		ТекущиеЗначенияПолей = NSI_РаботаСМастерДаннымиСервер.ПолучитьТекущиеЗначенияПолей(Объект.Ссылка);
		ЗаполнитьЗначенияСвойств(ЭтаФорма, ТекущиеЗначенияПолей);
	Иначе
		Владелец = Неопределено;
		Параметры.ЗначенияЗаполнения.Свойство("Владелец", Владелец);
		ЭтоГруппа = Неопределено;
		Параметры.Свойство("ЭтоГруппа", ЭтоГруппа);
		Если ЗначениеЗаполнено(Владелец) Тогда
			NSI_РаботаСМастерДаннымиСервер.ЗаполнитьГруппуФормыПоМакетуВидаМастерДанных(ЭтаФорма, Владелец, ЭтоГруппа=Истина, Элементы.ГруппаРеквизитов);	
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)
	ТекущийОбъект.ОписаниеПолей = NSI_РаботаСМастерДаннымиСерверПовторноеИспользование.ПолучитьОписаниеПолей(ТекущийОбъект.Владелец, ТекущийОбъект.ЭтоГруппа);
	ТекущийОбъект.СоответствиеПолей = Новый Структура;
	Для Каждого ОписаниеПоля Из ТекущийОбъект.ОписаниеПолей Цикл
		ТекущийОбъект.СоответствиеПолей.Вставить(ОписаниеПоля.ИмяПоля, ЭтаФорма[ОписаниеПоля.ИмяПоля]);	
	КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура ПоказатьЗначенияПериодическогоРеквизита(Кнопка)
	ИмяКнопки = Кнопка.Имя;
	ИмяКнопки = СтрЗаменить(ИмяКнопки, "ДР_","");
	ИмяКнопки = СтрЗаменить(ИмяКнопки, "_Периодический","");
	ОткрытьФорму("Справочник.NSI_МастерДанные.Форма.ФормаИсторииПериодическогоРеквизита", Новый Структура("МастерДанные, ИмяПоля", Объект.Ссылка, ИмяКнопки), ЭтаФорма,,,,,РежимОткрытияОкнаФормы.БлокироватьОкноВладельца);
КонецПроцедуры



