
// { События формы
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ОграничениеНаКоличествоИсполнителей = NSI_Задания.ПолучитьОграничениеНаКоличествоИсполнителей();
	ГлубинаХраненияИстории = NSI_Задания.ПолучитьГлубинуХраненияИстории();
	
	Отбор = Новый Структура("Метаданные", Метаданные.РегламентныеЗадания.NSI_МенеджерЗаданий);
	АктивныеРегламентныеЗадания = РегламентныеЗадания.ПолучитьРегламентныеЗадания(Отбор);
	
	МенеджерЗапущен = АктивныеРегламентныеЗадания.Количество() > 0;
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	ОбновитьДанныеПоИсполнителямИЗаданиям();
	ПодключитьОбработчикОжидания("ОбновитьДанныеПоИсполнителямИЗаданиям", 60);
КонецПроцедуры
// } События формы

// { Управляющие воздействия пользователя
&НаКлиенте
Процедура ЗапуститьМенеджераЗаданий(Команда)
	NSI_Задания.ЗапуститьМенеджераЗаданий();
	МенеджерЗапущен = Истина;
КонецПроцедуры

&НаКлиенте
Процедура ОстановитьМенеджераЗаданийИИсполнителей(Команда)
	NSI_Задания.ОстановитьМенеджераЗаданий();
	NSI_Задания.ОстановитьАктивныхИсполнителей();
	
	МенеджерЗапущен = Ложь;
	ОбновитьДанныеПоИсполнителямИЗаданиям();
КонецПроцедуры

&НаКлиенте
Процедура ОтменитьВсеЗаданияВОчереди(Команда)
	NSI_Задания.ОтменитьВсеЗаданияВОчереди();
	ОбновитьДанныеПоИсполнителямИЗаданиям();
КонецПроцедуры

&НаКлиенте
Процедура СохранитьОграничениеПоКоличествуИсполнителей(Команда)
	NSI_Задания.УстановитьОграничениеПоКоличествуИсполнителей(ОграничениеНаКоличествоИсполнителей);
КонецПроцедуры

&НаКлиенте
Процедура ПринудительноОбновитьДанныеПоИсполнителямИЗаданиям(Команда)
	ОбновитьДанныеПоИсполнителямИЗаданиям();
КонецПроцедуры

&НаКлиенте
Процедура СохранитьГлубинуХраненияИстории(Команда)
	NSI_Задания.УстановитьГлубинуХраненияИстории(ГлубинаХраненияИстории);
КонецПроцедуры

&НаКлиенте
Процедура Настройки(Команда)
	ФормаНастроек = ПолучитьФорму("РегистрСведений.NSI_НастройкиМетодовОбработчиков.ФормаСписка");
	ФормаНастроек.Открыть();
КонецПроцедуры
// } Управляющие воздействия пользователя

&НаКлиенте
Процедура ОбновитьДанныеПоИсполнителямИЗаданиям()
	КоличествоАктивныхИсполнителей = NSI_Задания.ПолучитьКоличествоАктивныхИсполнителей();
	КоличествоЗаданийВОчереди = NSI_Задания.ПолучитьКоличесвоЗаданийВОчереди();
	КоличествоЗаданийНаПаузе = NSI_Задания.ПолучитьКоличествоЗаданийНаПаузе();
	ВсегоАктивныхЗаданий = КоличествоАктивныхИсполнителей + КоличествоЗаданийВОчереди + КоличествоЗаданийНаПаузе;
КонецПроцедуры