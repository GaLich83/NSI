Функция ОтправитьСообщениеОСобытииОтЭлектронногоАрхива(Параметры) Экспорт
	БазаИсточник = Справочники.NSI_СписокВИБ.ЭлектронныйАрхив;
	Событие = Справочники.NSI_СобытияОповещений.СобытиеОтЭлектронногоАрхива;
	НаборПодписок = РегистрыСведений.NSI_ПодпискиНаСобытия.СоздатьНаборЗаписей();
	НаборПодписок.Отбор.Событие.Установить(Событие);
	НаборПодписок.Прочитать();
	Параметры = Новый ХранилищеЗначения(Новый Структура("SYSROWID", Параметры.SYSROWID), Новый СжатиеДанных(9));
	Для Каждого Подписка Из НаборПодписок Цикл
		Если Не Подписка.БазаИсточник.Пустая() И Не Подписка.БазаИсточник = БазаИсточник Тогда
			Продолжить;
		КонецЕсли;
		СобытиеКОтправке = Справочники.NSI_СобытияКОтправке.СоздатьЭлемент();
		СобытиеКОтправке.БазаИсточник = БазаИсточник;
		СобытиеКОтправке.БазаПолучатель = Подписка.БазаПодписчик;
		СобытиеКОтправке.Событие = Событие;
		СобытиеКОтправке.Параметры = Параметры;
		СобытиеКОтправке.Записать();
	КонецЦикла;
	Попытка                            
		МассивПараметров = Новый Массив;
		МассивПараметров.Добавить(Неопределено);
		ФоновыеЗадания.Выполнить("NSI_ОбщиеПроцедуры.ОтправитьОповещенияОСобытиях", МассивПараметров);
	Исключение
		Возврат Ложь;
	КонецПопытки;
	Возврат Истина;
КонецФункции
