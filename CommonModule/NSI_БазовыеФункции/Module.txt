Функция ПроверкаВалидностиИНН(ИНН) Экспорт
	Если СтрДлина(ИНН)=10 Тогда
		Возврат ПроверитьКонтрольнуюСумму10(ИНН);
	ИначеЕсли СтрДлина(ИНН)=12 Тогда
		Возврат ПроверитьКонтрольнуюСумму12(ИНН);
	Иначе
		Возврат Ложь;
	КонецЕсли;
КонецФункции

Функция ПроверитьКонтрольнуюСумму10(ИНН)
	МассивКоэффициентов = Новый Массив;
	МассивКоэффициентов.Добавить(2); 
	МассивКоэффициентов.Добавить(4); 
	МассивКоэффициентов.Добавить(10); 
	МассивКоэффициентов.Добавить(3); 
	МассивКоэффициентов.Добавить(5); 
	МассивКоэффициентов.Добавить(9); 
	МассивКоэффициентов.Добавить(4); 
	МассивКоэффициентов.Добавить(6); 
	МассивКоэффициентов.Добавить(8); 
	МассивКоэффициентов.Добавить(0);
	КонтрольнаяСумма = 0;
	Для Ц=0 По 8 Цикл
		Попытка
			КонтрольнаяСумма = КонтрольнаяСумма + Число(Сред(ИНН, Ц+1,1))*МассивКоэффициентов[Ц];
		Исключение
			Возврат Ложь;
		КонецПопытки;
	КонецЦикла;
	КонтрольноеЧисло = КонтрольнаяСумма%11%10;
	Попытка
		Возврат Число(Сред(ИНН, 10,1))=КонтрольноеЧисло;
	Исключение
		Возврат Ложь;
	КонецПопытки;
КонецФункции

Функция ПроверитьКонтрольнуюСумму12(ИНН)
	МассивКоэффициентов = Новый Массив;
	МассивКоэффициентов.Добавить(7); 
	МассивКоэффициентов.Добавить(2); 
	МассивКоэффициентов.Добавить(4); 
	МассивКоэффициентов.Добавить(10); 
	МассивКоэффициентов.Добавить(3); 
	МассивКоэффициентов.Добавить(5); 
	МассивКоэффициентов.Добавить(9); 
	МассивКоэффициентов.Добавить(4); 
	МассивКоэффициентов.Добавить(6); 
	МассивКоэффициентов.Добавить(8);
	МассивКоэффициентов.Добавить(0);
	КонтрольнаяСумма1 = 0;
	Для Ц=0 По 9 Цикл
		Попытка
			КонтрольнаяСумма1 = КонтрольнаяСумма1 + Число(Сред(ИНН, Ц+1,1))*МассивКоэффициентов[Ц];
		Исключение
			Возврат Ложь;
		КонецПопытки;
	КонецЦикла;
	КонтрольноеЧисло1 = КонтрольнаяСумма1%11%10;
	
	МассивКоэффициентов = Новый Массив;
	МассивКоэффициентов.Добавить(3); 
	МассивКоэффициентов.Добавить(7); 
	МассивКоэффициентов.Добавить(2); 
	МассивКоэффициентов.Добавить(4); 
	МассивКоэффициентов.Добавить(10); 
	МассивКоэффициентов.Добавить(3); 
	МассивКоэффициентов.Добавить(5); 
	МассивКоэффициентов.Добавить(9); 
	МассивКоэффициентов.Добавить(4); 
	МассивКоэффициентов.Добавить(6);
	МассивКоэффициентов.Добавить(8);
	МассивКоэффициентов.Добавить(0);
	КонтрольнаяСумма2 = 0;
	Для Ц=0 По 10 Цикл
		Попытка
			КонтрольнаяСумма2 = КонтрольнаяСумма2 + Число(Сред(ИНН, Ц+1,1))*МассивКоэффициентов[Ц];
		Исключение
			Возврат Ложь;
		КонецПопытки;
	КонецЦикла;
	КонтрольноеЧисло2 = КонтрольнаяСумма2%11%10;
	
	Попытка
		Возврат (Число(Сред(ИНН, 11,1))=КонтрольноеЧисло1) И (Число(Сред(ИНН, 12,1))=КонтрольноеЧисло2);
	Исключение                                         
		Возврат Ложь;
	КонецПопытки;
КонецФункции
