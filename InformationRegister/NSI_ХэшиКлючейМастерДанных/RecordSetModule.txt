Процедура ПередЗаписью(Отказ, Замещение)
	ТаблицаКлючей = Новый ТаблицаЗначений;
	ТаблицаКлючей.Колонки.Добавить("МастерДанные", Новый ОписаниеТипов("СправочникСсылка.NSI_МастерДанные"));
	ТаблицаКлючей.Колонки.Добавить("ХэшКлюча", Новый ОписаниеТипов("Строка",,,,Новый КвалификаторыСтроки(28,ДопустимаяДлина.Фиксированная)));
	Для Каждого Запись Из ЭтотОбъект Цикл
		НоваяСтрокаТаблицы = ТаблицаКлючей.Добавить();			
		НоваяСтрокаТаблицы.МастерДанные = Запись.МастерДанные;
		НоваяСтрокаТаблицы.ХэшКлюча = Запись.ХэшКлюча;
	КонецЦикла;
	Запрос = Новый Запрос("ВЫБРАТЬ
	                      |	ТЗ.МастерДанные,
	                      |	ТЗ.ХэшКлюча
	                      |ПОМЕСТИТЬ ТЗ
	                      |ИЗ
	                      |	&ТЗ КАК ТЗ
	                      |;
	                      |
	                      |////////////////////////////////////////////////////////////////////////////////
	                      |ВЫБРАТЬ ПЕРВЫЕ 1
	                      |	NSI_ХэшиКлючейМастерДанных.МастерДанные
	                      |ИЗ
	                      |	РегистрСведений.NSI_ХэшиКлючейМастерДанных КАК NSI_ХэшиКлючейМастерДанных
	                      |		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТЗ КАК ТЗ
	                      |		ПО NSI_ХэшиКлючейМастерДанных.ХэшКлюча = ТЗ.ХэшКлюча
	                      |			И NSI_ХэшиКлючейМастерДанных.МастерДанные <> ТЗ.МастерДанные");
	Запрос.УстановитьПараметр("ТЗ", ТаблицаКлючей);
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		Отказ = Истина;
		ВызватьИсключение "Обнаружено дублирование данных с элементом "+Выборка.МастерДанные;
	КонецЕсли;
КонецПроцедуры

