
&НаСервере
Процедура ПриЧтенииНаСервере(ТекущийОбъект)
	СписокПараметровОбъекта = ТекущийОбъект.ПараметрыОповещения.Получить();
	Если СписокПараметровОбъекта = Неопределено Тогда
		СписокПараметровОбъекта = Новый Структура;
	КонецЕсли;
	СписокПараметров.Очистить();
	Если Не ТекущийОбъект.ШаблонОповещения.Пустая() Тогда
		Для Каждого СтрокаПараметра Из ТекущийОбъект.ШаблонОповещения.ИспользуемыеПараметры Цикл
			СтрокаСписка = СписокПараметров.Добавить();
			СтрокаСписка.Параметр = СтрокаПараметра.Параметр;
			СтрокаСписка.ТипПараметра = СтрокаПараметра.ТипПараметра.Получить();
			СтрокаСписка.Значение = ?(СписокПараметровОбъекта.Свойство(СтрокаПараметра.Параметр), СписокПараметровОбъекта[СтрокаПараметра.Параметр], Неопределено);
		КонецЦикла;
	КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)
	СписокПараметровОбъекта = Новый Структура;
	Для Каждого СтрокаПараметра Из СписокПараметров Цикл
		СписокПараметровОбъекта.Вставить(СтрокаПараметра.Параметр, СтрокаПараметра.Значение);
	КонецЦикла;
	ТекущийОбъект.ПараметрыОповещения = Новый ХранилищеЗначения(СписокПараметровОбъекта);
КонецПроцедуры

&НаКлиенте
Процедура ШаблонОповещенияПриИзменении(Элемент)
	ПолучитьСписокПараметров();	
КонецПроцедуры

&НаСервере
Процедура ПолучитьСписокПараметров()
	СписокПараметровОбъекта = Новый Структура;
	Для Каждого СтрокаПараметра Из СписокПараметров Цикл
		СписокПараметровОбъекта.Вставить(СтрокаПараметра.Параметр, СтрокаПараметра.Значение);
	КонецЦикла;
	СписокПараметров.Очистить();
	Если Не Запись.ШаблонОповещения.Пустая() Тогда
		Для Каждого СтрокаПараметра Из Запись.ШаблонОповещения.ИспользуемыеПараметры Цикл
			СтрокаСписка = СписокПараметров.Добавить();
			СтрокаСписка.Параметр = СтрокаПараметра.Параметр;
			СтрокаСписка.ТипПараметра = СтрокаПараметра.ТипПараметра.Получить();
			СтрокаСписка.Значение = ?(СписокПараметровОбъекта.Свойство(СтрокаПараметра.Параметр), СписокПараметровОбъекта[СтрокаПараметра.Параметр], Неопределено);
		КонецЦикла;
	КонецЕсли;	
КонецПроцедуры

&НаСервереБезКонтекста
Функция ПолучитьРеквизитИзСсылки(Ссылка, ИмяРеквизита)
	Возврат Ссылка[ИмяРеквизита];
КонецФункции


&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Запись.ИсходныйКлючЗаписи.Пустой() Тогда
		Запись.Статус = Перечисления.NSI_СтатусыСобытийОповещений.Создано;
	КонецЕсли;
КонецПроцедуры


&НаКлиенте
Процедура Проверить(Команда)
	Записать();
	ПроверитьНаСервере(Запись.ИсходныйКлючЗаписи);
КонецПроцедуры

&НаСервереБезКонтекста
Процедура ПроверитьНаСервере(Ключ)
	РегистрыСведений.NSI_РегистрацияСобытийОповещения.ПолучитьТаблицуОповещений(Ключ);
КонецПроцедуры

