
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Параметры.Свойство("СтрокаНаИсходномЯзыке", СтрокаНаИсходномЯзыке);
	Параметры.Свойство("ЯзыкИсходный", ЯзыкИсходный);
	Для Каждого Язык Из Метаданные.Языки Цикл
		Элементы.Язык.СписокВыбора.Добавить(Язык.КодЯзыка, Язык.Синоним);
	КонецЦикла;
	ПрочитатьУжеЗаписаное();
КонецПроцедуры

&НаСервере
Процедура ПрочитатьУжеЗаписаное()
	ТаблицаПереводов.Очистить();
	Для Каждого Язык Из Метаданные.Языки Цикл
		Если Язык.КодЯзыка = ЯзыкИсходный Тогда
			Продолжить;
		КонецЕсли;
		Строка = ТаблицаПереводов.Добавить();
		ЗаписьПеревода = РегистрыСведений.NSI_Глоссарий.СоздатьМенеджерЗаписи();
		ЗаписьПеревода.ЯзыкИсходный = ЯзыкИсходный;
		ЗаписьПеревода.ЯзыкНазначения = Язык.КодЯзыка;
		ЗаписьПеревода.СтрокаНаИсходномЯзыке = СтрокаНаИсходномЯзыке;
		ЗаписьПеревода.Прочитать();
		ЗаполнитьЗначенияСвойств(Строка, ЗаписьПеревода);
		Строка.ЯзыкНазначения = Язык.КодЯзыка;
    КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура Записать(Команда)
	ЗаписатьНаСервере();
	Закрыть();
КонецПроцедуры

&НаСервере
Процедура ЗаписатьНаСервере()
	НаборЗаписей = РегистрыСведений.NSI_Глоссарий.СоздатьНаборЗаписей();
	НаборЗаписей.Отбор.ЯзыкИсходный.Установить(ЯзыкИсходный);
	НаборЗаписей.Отбор.СтрокаНаИсходномЯзыке.Установить(СтрокаНаИсходномЯзыке);
	Для Каждого Строк Из ТаблицаПереводов Цикл
		Запись = НаборЗаписей.Добавить();
		Запись.ЯзыкИсходный = ЯзыкИсходный;
		Запись.СтрокаНаИсходномЯзыке = СтрокаНаИсходномЯзыке;
		ЗаполнитьЗначенияСвойств(Запись, Строк);
	КонецЦикла;
	НаборЗаписей.Записать(Истина);
КонецПроцедуры

&НаКлиенте
Процедура ИмяЭлементаАвтоПодбор(Элемент, Текст, ДанныеВыбора, Параметры, Ожидание, СтандартнаяОбработка)
	ДанныеВыбора = ВыполнитьПодборНаСервере(Текст);
КонецПроцедуры

&НаСервереБезКонтекста
Функция ВыполнитьПодборНаСервере(Текст)
	Запрос = Новый Запрос("ВЫБРАТЬ РАЗЛИЧНЫЕ ПЕРВЫЕ 49
	                      |	lang_Глоссарий.ИмяЭлемента
	                      |ИЗ
	                      |	РегистрСведений.NSI_Глоссарий КАК lang_Глоссарий
	                      |ГДЕ
	                      |	lang_Глоссарий.ИмяЭлемента ПОДОБНО ""%"" + &Текст + ""%""");
	Запрос.УстановитьПараметр("Текст", Текст);
	Возврат Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("ИмяЭлемента");
КонецФункции
 