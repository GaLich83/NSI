
&НаКлиенте
Процедура ПоказатьСтруктуруДо(Команда)
	ОчиститьСообщения();
	ПоказатьСтруктуруНаСервере("До", Элементы.Список.ТекущиеДанные.ИДПакета, Элементы.Список.ТекущиеДанные.Порядок);
КонецПроцедуры

&НаСервере
Процедура ПоказатьСтруктуруНаСервере(ЧтоОтображать="До", ИДПакета, Порядок)
	Запись = РегистрыСведений.NSI_ИзмененныеОбъекты.СоздатьМенеджерЗаписи();
	Запись.ИДПакета = ИДПакета;
	Запись.Порядок = Порядок;
	Запись.Прочитать();
	Если ЧтоОтображать = "До" Тогда
		Хранилище = Запись.ДоИзменения;
	ИначеЕсли ЧтоОтображать = "После" Тогда
		Хранилище = Запись.ПослеИзменения;
	Иначе
		Возврат;
	КонецЕсли;
	Таблица = Хранилище.Получить();
	Если ТипЗнч(Таблица) = Тип("ТаблицаЗначений") Тогда
		Для Каждого Реквизит Из Таблица Цикл
			Если ТипЗнч(Реквизит.Значение) = Тип("Массив") Тогда
				Ц = 0;
				Сообщить(Реквизит.Синоним+" = ТЧ {");
				Для Каждого Строк Из Реквизит.Значение Цикл
					Сообщить("  ["+Ц+"]");
					Если ТипЗнч(Строк) = Тип("ТаблицаЗначений") Тогда
						Для Каждого СтрокРеквизит Из Строк Цикл
							Сообщить("    "+СтрокРеквизит.Синоним+" = "+СтрокРеквизит.Значение);
						КонецЦикла;
					КонецЕсли;
					Ц = Ц+1;
				КонецЦикла;
				Сообщить("}");
			Иначе
				Сообщить(Реквизит.Синоним+" = "+Строка(Реквизит.Значение));
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
КонецПроцедуры

Процедура ПоказатьСтруктуруИзмененийНаСервере(ИДПакета, Порядок)
	Запись = РегистрыСведений.NSI_ИзмененныеОбъекты.СоздатьМенеджерЗаписи();
	Запись.ИДПакета = ИДПакета;
	Запись.Порядок = Порядок;
	Запись.Прочитать();
	Хранилище = Запись.СписокИзмененныхРеквизитов;  
	Таблица = Хранилище.Получить();
	Если ТипЗнч(Таблица) = Тип("ТаблицаЗначений") Тогда
		Для Каждого Реквизит Из Таблица Цикл
			Если Реквизит.ЭтоТаблица Тогда
				Ц = 0;
				Сообщить(Реквизит.Синоним+" = ТЧ {");
				Для Каждого Строк Из Реквизит.До Цикл
					Если ТипЗнч(Строк.Значение) = Тип("ТаблицаЗначений") Тогда
						Сообщить("  "+Строк.Синоним);
						Для Каждого СтрокРеквизит Из Строк.Значение Цикл
							Сообщить("    "+СтрокРеквизит.Синоним+". До: "+Строка(СтрокРеквизит.До)+", после: "+Строка(СтрокРеквизит.После));
						КонецЦикла;
					КонецЕсли;
					Ц = Ц+1;
				КонецЦикла;
				Сообщить("}");
			Иначе
				Сообщить(Реквизит.Синоним+". До: "+Строка(Реквизит.До)+", после: "+Строка(Реквизит.После));
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;	
КонецПроцедуры


&НаКлиенте
Процедура ПоказатьСтруктуруПосле(Команда)
	ОчиститьСообщения();
	ПоказатьСтруктуруНаСервере("После", Элементы.Список.ТекущиеДанные.ИДПакета, Элементы.Список.ТекущиеДанные.Порядок);
КонецПроцедуры

&НаКлиенте
Процедура ПоказатьСтруктуруИзменений(Команда)
	ОчиститьСообщения();
	ПоказатьСтруктуруИзмененийНаСервере(Элементы.Список.ТекущиеДанные.ИДПакета, Элементы.Список.ТекущиеДанные.Порядок);	
КонецПроцедуры

